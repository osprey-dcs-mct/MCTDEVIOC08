record(ai, "$(P)VCENTRE_TARGET1") {
    field(DESC, "Tgt centre when DMM and VBM are out")
    field(VAL,  "0.0")

    info(autosaveFields, "VAL")
}

record(calc, "$(P)VCENTRE_STATUS1"){
    field(DESC, "Status if DMM and VBM are out")
    field(INPA, "$(P)VCENTRE CP")
    field(INPB, "$(P)VCENTRE_TARGET1 CP")
    field(INPC, "0.1")
    field(CALC, "ABS(A-B)<C")
}

record(ai, "$(P)VCENTRE_TARGET2") {
    field(DESC, "Tgt centre when DMM is in and VBM out")
    field(INP,  "MCTMONO01MOT03.RBV CPP")
}

record(calc, "$(P)VCENTRE_STATUS2"){
    field(DESC, "Status if DMM is in")
    field(INPA, "$(P)VCENTRE CP")
    field(INPB, "$(P)VCENTRE_TARGET2 CP")
    field(INPC, "0.1")
    field(CALC, "ABS(A-B)<C")
}

record(calc, "$(P)VCENTRE_TARGET3") {
    field(DESC, "Tgt centre when VBM is in")
    field(INPA, "MCTVBM01:HEIGHT.RBV CPP")
    field(INPB, "MCTVBM01:PITCH.RBV CPP")
    field(INPC, "$(VBMZ)")
    field(INPD, "$(SLT03Z)")
    field(INPE, "0.001")
    field(CALC, "A+B*(D-C)*2*E")
}

record(calc, "$(P)VCENTRE_STATUS3"){
    field(DESC, "Status if VBM is in")
    field(INPA, "$(P)VCENTRE CP")
    field(INPB, "$(P)VCENTRE_TARGET3 CP")
    field(INPC, "0.1")
    field(CALC, "ABS(A-B)<C")
}

record(calcout, "$(P)VCENTRE_STATUS_CALC"){
    field(DESC, "Select calc based on VBM and DMM status")
    field(INPA, "MCTMONO01:IN_SERVICE CP")
    field(INPB, "MCTVBM01:IN_SERVICE CP")
    field(INPC, "$(P)VCENTRE_STATUS1 CP")
    field(INPD, "$(P)VCENTRE_STATUS2 CP")
    field(INPE, "$(P)VCENTRE_STATUS3 CP")
    field(CALC, "!(A||B)?C:B?E:D")
    field(OUT,  "$(P)VCENTRE_STATUS PP")
}

record(bi, "$(P)VCENTRE_STATUS") {
    field(DESC, "Y centre status based on DMM")
    field(ZNAM, "Not in pos.")
    field(ZSV,  "MINOR")
    field(ONAM, "In posn.")
    field(OSV,  "NO_ALARM")
}
